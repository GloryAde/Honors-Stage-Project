@namespace HSP.Layout
@inherits LayoutComponentBase

@using Microsoft.AspNetCore.Components.Authorization
@using System.Security.Claims

<AuthorizeView>
    <Authorized>
        <div class="page">
            <div class="sidebar">
                <NavMenu />
            </div>

            <main>
                <div class="top-row px-4">
                    <div class="top-row-content">
                        @{
                            var role = context.User.Claims
                                .FirstOrDefault(c => c.Type == ClaimTypes.Role)?.Value ?? "User";
                            var userName = context.User.Identity?.Name ?? "Guest";
                            
                            // Format role for display
                            var displayRole = role switch
                            {
                                "Admin" => "Administrator",
                                "Teacher" => "Teacher",
                                "Student" => "Student",
                                _ => role
                            };
                        }
                        <span class="user-welcome">Welcome @displayRole, @userName</span>
                        <a href="/logout" class="logout-link">Logout</a>
                    </div>
                </div>

                <article class="content px-4">
                    @Body
                </article>
            </main>
        </div>
    </Authorized>
    <NotAuthorized>
        <div class="page-no-sidebar">
            <header class="simple-header">
                <div class="simple-header-content">
                    <a href="/" class="header-logo">HSP</a>
                    <div class="header-links">
                        <a href="/login">Login</a>
                        <a href="/register">Register</a>
                    </div>
                </div>
            </header>
            <div class="main-content">
                <article class="content px-4">
                    @Body
                </article>
            </div>
        </div>
    </NotAuthorized>
</AuthorizeView>

<div id="blazor-error-ui">
    An unhandled error has occurred.
    <a href="" class="reload">Reload</a>
    <a class="dismiss">🗙</a>
</div>
